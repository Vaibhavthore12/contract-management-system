{
    "openapi": "3.0.3",
    "info": {
        "title": "Contract Management Platform API",
        "description": "RESTful API for managing contract blueprints and contract lifecycle",
        "version": "1.0.0",
        "contact": {
            "name": "API Support"
        }
    },
    "servers": [
        {
            "url": "https://contract-management-system-opal.vercel.app",
            "description": "Production server"
        },
        {
            "url": "http://localhost:3000",
            "description": "Development server"
        }
    ],
    "tags": [
        {
            "name": "Blueprints",
            "description": "Blueprint template management"
        },
        {
            "name": "Contracts",
            "description": "Contract instance management"
        },
        {
            "name": "Lifecycle",
            "description": "Contract lifecycle transitions"
        }
    ],
    "paths": {
        "/api/blueprints": {
            "get": {
                "tags": [
                    "Blueprints"
                ],
                "summary": "List all blueprints",
                "responses": {
                    "200": {
                        "description": "List of blueprints",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Blueprint"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Blueprints"
                ],
                "summary": "Create a new blueprint",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateBlueprintRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Blueprint created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Blueprint"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/blueprints/{id}": {
            "get": {
                "tags": [
                    "Blueprints"
                ],
                "summary": "Get blueprint by ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Blueprint details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Blueprint"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Blueprint not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": [
                    "Blueprints"
                ],
                "summary": "Update blueprint",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateBlueprintRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Blueprint updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Blueprint"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Cannot modify blueprint with existing contracts"
                    },
                    "404": {
                        "description": "Blueprint not found"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Blueprints"
                ],
                "summary": "Delete blueprint",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Blueprint deleted"
                    },
                    "400": {
                        "description": "Cannot delete blueprint with existing contracts"
                    },
                    "404": {
                        "description": "Blueprint not found"
                    }
                }
            }
        },
        "/api/contracts": {
            "get": {
                "tags": [
                    "Contracts"
                ],
                "summary": "List contracts",
                "parameters": [
                    {
                        "name": "filter",
                        "in": "query",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "all",
                                "active",
                                "pending",
                                "signed"
                            ]
                        },
                        "description": "Filter contracts by status group"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of contracts",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Contract"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Contracts"
                ],
                "summary": "Create contract from blueprint",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateContractRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Contract created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Contract"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "404": {
                        "description": "Blueprint not found"
                    }
                }
            }
        },
        "/api/contracts/{id}": {
            "get": {
                "tags": [
                    "Contracts"
                ],
                "summary": "Get contract by ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Contract details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Contract"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Contract not found"
                    }
                }
            },
            "put": {
                "tags": [
                    "Contracts"
                ],
                "summary": "Update contract field values",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "fieldValues": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "properties": {
                                                "blueprintFieldId": {
                                                    "type": "string"
                                                },
                                                "value": {
                                                    "type": "string"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Contract updated"
                    },
                    "400": {
                        "description": "Cannot modify locked/revoked contract"
                    },
                    "404": {
                        "description": "Contract not found"
                    }
                }
            }
        },
        "/api/contracts/{id}/transition": {
            "get": {
                "tags": [
                    "Lifecycle"
                ],
                "summary": "Get allowed transitions for contract",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Allowed transitions",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "type": "object",
                                            "properties": {
                                                "currentStatus": {
                                                    "type": "string"
                                                },
                                                "allowedTransitions": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Lifecycle"
                ],
                "summary": "Transition contract to new status",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "targetStatus"
                                ],
                                "properties": {
                                    "targetStatus": {
                                        "type": "string",
                                        "enum": [
                                            "approved",
                                            "sent",
                                            "signed",
                                            "locked",
                                            "revoked"
                                        ]
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Transition successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Contract"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid transition",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "Blueprint": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string",
                        "nullable": true
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "fields": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/BlueprintField"
                        }
                    }
                }
            },
            "BlueprintField": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "text",
                            "date",
                            "signature",
                            "checkbox"
                        ]
                    },
                    "label": {
                        "type": "string"
                    },
                    "positionX": {
                        "type": "integer"
                    },
                    "positionY": {
                        "type": "integer"
                    },
                    "order": {
                        "type": "integer"
                    }
                }
            },
            "Contract": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string",
                        "enum": [
                            "created",
                            "approved",
                            "sent",
                            "signed",
                            "locked",
                            "revoked"
                        ]
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "blueprint": {
                        "$ref": "#/components/schemas/Blueprint"
                    },
                    "fieldValues": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ContractFieldValue"
                        }
                    }
                }
            },
            "ContractFieldValue": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "blueprintFieldId": {
                        "type": "string"
                    },
                    "value": {
                        "type": "string"
                    }
                }
            },
            "CreateBlueprintRequest": {
                "type": "object",
                "required": [
                    "name",
                    "fields"
                ],
                "properties": {
                    "name": {
                        "type": "string",
                        "minLength": 1
                    },
                    "description": {
                        "type": "string"
                    },
                    "fields": {
                        "type": "array",
                        "minItems": 1,
                        "items": {
                            "type": "object",
                            "required": [
                                "type",
                                "label"
                            ],
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "enum": [
                                        "text",
                                        "date",
                                        "signature",
                                        "checkbox"
                                    ]
                                },
                                "label": {
                                    "type": "string",
                                    "minLength": 1
                                },
                                "positionX": {
                                    "type": "integer",
                                    "default": 0
                                },
                                "positionY": {
                                    "type": "integer",
                                    "default": 0
                                },
                                "order": {
                                    "type": "integer"
                                }
                            }
                        }
                    }
                }
            },
            "CreateContractRequest": {
                "type": "object",
                "required": [
                    "blueprintId",
                    "name"
                ],
                "properties": {
                    "blueprintId": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string",
                        "minLength": 1
                    },
                    "fieldValues": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "blueprintFieldId": {
                                    "type": "string"
                                },
                                "value": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            },
            "ErrorResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": false
                    },
                    "error": {
                        "type": "string"
                    }
                }
            }
        }
    }
}